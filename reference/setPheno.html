<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Set phenotypes — setPheno • AlphaSimR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Set phenotypes — setPheno"><meta name="description" content="Sets phenotypes for all traits by adding random error
from a multivariate normal distribution."><meta property="og:description" content="Sets phenotypes for all traits by adding random error
from a multivariate normal distribution."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AlphaSimR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/AlphaSimR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DataImport.html">Data Import</a></li>
    <li><a class="dropdown-item" href="../articles/Genome.html">Genome</a></li>
    <li><a class="dropdown-item" href="../articles/GenomicSelection.html">Genomic Selection</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to AlphaSimR</a></li>
    <li><a class="dropdown-item" href="../articles/Meiosis.html">Meiosis</a></li>
    <li><a class="dropdown-item" href="../articles/Misc.html">Misc</a></li>
    <li><a class="dropdown-item" href="../articles/QuantGen.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/traits.html">Traits in AlphaSimR</a></li>
    <li><a class="dropdown-item" href="../articles/Traits.html">Traits</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gaynorr/AlphaSimR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Set phenotypes</h1>
      <small class="dont-index">Source: <a href="https://github.com/gaynorr/AlphaSimR/blob/master/R/phenotypes.R" class="external-link"><code>R/phenotypes.R</code></a></small>
      <div class="d-none name"><code>setPheno.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sets phenotypes for all traits by adding random error
from a multivariate normal distribution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setPheno</span><span class="op">(</span></span>
<span>  <span class="va">pop</span>,</span>
<span>  h2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  H2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  varE <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  corE <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fixEff <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  onlyPheno <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  traits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  simParam <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pop">pop<a class="anchor" aria-label="anchor" href="#arg-pop"></a></dt>
<dd><p>an object of <code><a href="Pop-class.html">Pop-class</a></code> or
<code><a href="HybridPop-class.html">HybridPop-class</a></code></p></dd>


<dt id="arg-h-">h2<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>a vector of desired narrow-sense heritabilities for
each trait. See details.</p></dd>


<dt id="arg-h-">H2<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>a vector of desired broad-sense heritabilities for
each trait. See details.</p></dd>


<dt id="arg-vare">varE<a class="anchor" aria-label="anchor" href="#arg-vare"></a></dt>
<dd><p>error (co)variances for traits. See details.</p></dd>


<dt id="arg-core">corE<a class="anchor" aria-label="anchor" href="#arg-core"></a></dt>
<dd><p>an optional matrix for correlations between errors.
See details.</p></dd>


<dt id="arg-reps">reps<a class="anchor" aria-label="anchor" href="#arg-reps"></a></dt>
<dd><p>number of replications for phenotype. See details.</p></dd>


<dt id="arg-fixeff">fixEff<a class="anchor" aria-label="anchor" href="#arg-fixeff"></a></dt>
<dd><p>fixed effect to assign to the population. Used
by genomic selection models only.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>the p-value for the environmental covariate
used by GxE traits. If NULL, a value is
sampled at random.</p></dd>


<dt id="arg-onlypheno">onlyPheno<a class="anchor" aria-label="anchor" href="#arg-onlypheno"></a></dt>
<dd><p>should only the phenotype be returned, see return</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>an integer vector indicate which traits to set. If NULL,
all traits will be set.</p></dd>


<dt id="arg-simparam">simParam<a class="anchor" aria-label="anchor" href="#arg-simparam"></a></dt>
<dd><p>an object of <code><a href="SimParam.html">SimParam</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an object of <code><a href="Pop-class.html">Pop-class</a></code> or
<code><a href="HybridPop-class.html">HybridPop-class</a></code> if onlyPheno=FALSE, if
onlyPheno=TRUE a matrix is returned</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are three arguments for setting the error variance of a
phenotype: h2, H2, and varE. The user should only use one of these
arguments. If the user supplies values for more than one, only one
will be used according to order in which they are listed above.</p>
<p>The h2 argument allows the user to specify the error variance
according to narrow-sense heritability. This calculation uses the
additive genetic variance and total genetic variance in the founder
population. Thus, the heritability relates to the founder population
and not the current population.</p>
<p>The H2 argument allows the user to specify the error variance
according to broad-sense heritability. This calculation uses the
total genetic variance in the founder population. Thus, the heritability
relates to the founder population and not the current population.</p>
<p>The varE argument allows the user to specify the error variance
directly. The user may supply a vector describing the error variance
for each trait or supply a matrix that specify the covariance of
the errors.</p>
<p>The corE argument allows the user to specify correlations for the
error covariance matrix. These correlations are be supplied in addition
to the h2, H2, or varE arguments. These correlations will be used to
construct a covariance matrix from a vector of variances. If the user
supplied a covariance matrix to varE, these correlations will supercede
values provided in that matrix.</p>
<p>The reps parameter is for convenient representation of replicated data.
It is intended to represent replicated yield trials in plant
breeding programs. In this case, varE is set to the plot error and
reps is set to the number of plots per entry. The resulting phenotype
represents the entry-means.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Create founder haplotypes</span></span></span>
<span class="r-in"><span><span class="va">founderPop</span> <span class="op">=</span> <span class="fu"><a href="quickHaplo.html">quickHaplo</a></span><span class="op">(</span>nInd<span class="op">=</span><span class="fl">10</span>, nChr<span class="op">=</span><span class="fl">1</span>, segSites<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Set simulation parameters</span></span></span>
<span class="r-in"><span><span class="va">SP</span> <span class="op">=</span> <span class="va"><a href="SimParam.html">SimParam</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">founderPop</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SP</span><span class="op">$</span><span class="fu">addTraitA</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Create population</span></span></span>
<span class="r-in"><span><span class="va">pop</span> <span class="op">=</span> <span class="fu"><a href="newPop.html">newPop</a></span><span class="op">(</span><span class="va">founderPop</span>, simParam<span class="op">=</span><span class="va">SP</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Add phenotype with error variance of 1</span></span></span>
<span class="r-in"><span><span class="va">pop</span> <span class="op">=</span> <span class="fu">setPheno</span><span class="op">(</span><span class="va">pop</span>, varE<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in get("SP", envir = .GlobalEnv):</span> object 'SP' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chris Gaynor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

